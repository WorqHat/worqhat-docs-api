---
title: 'Working with File-Based Workflow Triggers'
description: 'Learn how to trigger WorqHat workflows using file uploads or URLs'
---

# Working with File-Based Workflow Triggers

WorqHat workflows can process various types of files, from documents and images to data files and media. This guide explains how to trigger workflows using file uploads or by providing URLs to files, enabling powerful document processing, media analysis, and data extraction capabilities.

## Understanding File-Based Workflow Triggers

File-based triggers allow you to send files to your workflows for processing. WorqHat supports two primary methods:

1. **Direct File Upload**: Upload a file directly from your application or system
2. **URL-Based Processing**: Provide a URL to a publicly accessible file that WorqHat will download and process

## When to Use File-Based Triggers

File-based workflow triggers are ideal for scenarios like:

- Document processing and analysis
- Image recognition and processing
- Data extraction from structured files (CSV, Excel, etc.)
- Media transcription and analysis
- Report generation from uploaded data
- Processing user-submitted files in your applications

## Prerequisites

Before triggering a workflow with files, you'll need:

1. A WorqHat account with workflow creation permissions
2. An API key with appropriate permissions
3. The workflow ID of the workflow you want to trigger
4. Files to process or URLs pointing to files

## Sending Files to a Workflow

### Method 1: Direct File Upload

When you have a file locally available in your application, you can upload it directly to the workflow:

```javascript
import Worqhat from 'worqhat';
import fs from 'fs';
import path from 'path';

// Initialize the WorqHat client
const client = new Worqhat({
  apiKey: process.env.WORQHAT_API_KEY,
});

async function processDocument() {
  try {
    // Read the file from the filesystem
    const filePath = path.resolve('./contract.pdf');
    const fileBuffer = fs.readFileSync(filePath);
    
    // Add metadata to provide context for the workflow
    const metadata = {
      documentType: "contract",
      priority: "high",
      department: "legal",
      requestedBy: "jane.smith@example.com"
    };
    
    // Trigger the document processing workflow
    const response = await client.flows.triggerWithFile(
      'document-processing-workflow-id',
      {
        file: fileBuffer,
        metadata: metadata
      }
    );
    
    console.log(`Document processing started! Tracking ID: ${response.analytics_id}`);
    return response;
  } catch (error) {
    console.error('Error processing document:', error);
    // Handle the error appropriately
  }
}

processDocument();
```

### Method 2: URL-Based Processing

When the file is available at a URL (such as in cloud storage or a public web location), you can simply provide the URL:

```javascript
import Worqhat from 'worqhat';

// Initialize the WorqHat client
const client = new Worqhat({
  apiKey: process.env.WORQHAT_API_KEY,
});

async function processRemoteImage() {
  try {
    // Metadata to provide context for the workflow
    const metadata = {
      imageType: "product",
      category: "electronics",
      productId: "PROD-12345"
    };
    
    // Trigger the image analysis workflow with a URL
    const response = await client.flows.triggerWithFile(
      'image-analysis-workflow-id',
      {
        url: 'https://storage.example.com/products/laptop-x1.jpg',
        metadata: metadata
      }
    );
    
    console.log(`Image analysis started! Tracking ID: ${response.analytics_id}`);
    return response;
  } catch (error) {
    console.error('Error processing remote image:', error);
    // Handle the error appropriately
  }
}

processRemoteImage();
```

## Working with Responses

When you trigger a workflow with a file, you'll receive an immediate response confirming that the workflow has started processing your file. The actual processing happens asynchronously.

A typical response includes:

```json
{
  "success": true,
  "message": "Workflow triggered successfully with file upload",
  "analytics_id": "1f9152dc-dec8-496f-8ba4-ed1c27a72684",
  "timestamp": "2025-07-26T03:28:08.123Z",
  "data": {
    "workflow_status": "started",
    "file_received": true
  }
}
```

## Best Practices

### File Size and Type Considerations

- **File Size Limits**: WorqHat supports files up to 100MB. For larger files, consider breaking them into smaller chunks or using cloud storage with URL-based processing.
- **Supported File Types**: Most common file types are supported, including:
  - Documents: PDF, DOCX, TXT, RTF
  - Images: JPG, PNG, GIF, TIFF, WebP
  - Data: CSV, JSON, XML, XLSX
  - Media: MP3, MP4, WAV (size restrictions apply)

### Security Best Practices

- Always validate files before uploading them to workflows
- Use HTTPS for all API communications
- For sensitive documents, consider implementing additional encryption
- When using URL-based processing, ensure the URLs are properly secured and temporary if needed

### Error Handling

Implement robust error handling for common file-related issues:

```javascript
try {
  const response = await client.flows.triggerWithFile(workflowId, { file: fileBuffer });
  // Handle success
} catch (error) {
  if (error.status === 413) {
    console.error('File too large. Maximum size is 100MB.');
  } else if (error.status === 415) {
    console.error('Unsupported file type.');
  } else if (error.status === 400) {
    console.error('Invalid request format:', error.message);
  } else {
    console.error('Unexpected error:', error);
  }
}
```

## Real-World Use Cases

### Document Processing System

Create a document processing system that extracts information from invoices:

```javascript
// Process an invoice PDF
const response = await client.flows.triggerWithFile('invoice-processing-workflow-id', {
  file: invoiceFileBuffer,
  metadata: {
    company: "Acme Corp",
    department: "Accounts Payable",
    expectedTotal: 1250.00,
    currency: "USD",
    urgent: true
  }
});

// Store the analytics_id to check processing status later
const processingId = response.analytics_id;
```

### Media Analysis Pipeline

Build a media analysis pipeline that processes video content:

```javascript
// Process a video file from a URL
const response = await client.flows.triggerWithFile('video-analysis-workflow-id', {
  url: 'https://storage.example.com/videos/product-demo-v2.mp4',
  metadata: {
    title: "Product Demo - Version 2",
    duration: 187, // seconds
    language: "en-US",
    requireTranscription: true,
    extractKeyMoments: true
  }
});
```

## Combining File Uploads with JSON Payloads

For complex workflows, you might want to use both file uploads and JSON payloads together. This can be achieved by:

1. First uploading the file using the file-based trigger
2. Using the `analytics_id` from the response to correlate with subsequent JSON payload triggers
3. Including the `analytics_id` in your JSON payload to link the processes

## Conclusion

File-based workflow triggers provide a powerful way to process documents, images, and other files in your WorqHat workflows. By leveraging both direct file uploads and URL-based processing, you can build sophisticated document processing systems, media analysis pipelines, and data extraction solutions that integrate seamlessly with your applications.

For more advanced use cases, consider exploring workflow chaining and combining file-based triggers with other trigger types to create comprehensive data processing solutions.